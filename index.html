<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測試</title>
</head>
<body>
    <h1>測試股份有限公司</h1>
    <p>姓名：王小美</p>
    <p>聯絡方式：0987654321</p>
    <p>地址：太平洋中間</p>
    <p>公司：測試股份有限公司</p>
    <p>LINE ID：test</p>
    <p>email：test@gmail.com</p>
    <p>頭銜：Manager | Sales</p>
    <img src="./photo.jpg" alt="">
    <button id="downloadVcardBtn">加為聯絡人</button>

    <script>
        document.getElementById('downloadVcardBtn').addEventListener('click', function() {
            var vcardData = 'BEGIN:VCARD\n' +
                            'VERSION:4.0\n' +
                            'N:王小美\n' +
                            'TEL;TYPE=CELL:0987654321\n' +
                            'ORG:測試公司\n' +
                            'PHOTO;JPEG:https://ruiyuuu.github.io/test/photo.jpg'+
                            'ADR:太平洋中間'+
                            'EMAIL:test@gmail.com'+
                            'URL:www.google.com'+
                            'CATEGORIES:老師'+
                            'FBURL:GOGO保'+
                            // 'LOGO;PNG:https://ruiyuuu.github.io/test/photo.jpg'+
                            // 'NICKNAME:Jon,Johnny'+
                            // 'X-LINE:test'+
                            // 'TITLE:Manager'+
                            // 'ROLE:Sales'+
                            'END:VCARD';

            var blob = new Blob([vcardData], { type: 'text/vcard' });
            var url = window.URL.createObjectURL(blob);

            var a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = 'contact.vcf';
            document.body.appendChild(a);
            a.click();

            window.URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>